<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Data Visualization with ggplot2 | 2020-01-15-brynmawr</title>
  <meta name="description" content="This is a review of the material covered in Bryn Mawr College’s Data Carpentry: R for the Social Sciences Workshop, held 01/15-16/2020." />
  <meta name="generator" content="bookdown 0.16 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Data Visualization with ggplot2 | 2020-01-15-brynmawr" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a review of the material covered in Bryn Mawr College’s Data Carpentry: R for the Social Sciences Workshop, held 01/15-16/2020." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Data Visualization with ggplot2 | 2020-01-15-brynmawr" />
  
  <meta name="twitter:description" content="This is a review of the material covered in Bryn Mawr College’s Data Carpentry: R for the Social Sciences Workshop, held 01/15-16/2020." />
  

<meta name="author" content="Kelsey Gonzalez, Amelia McNamara, The Carpentries" />


<meta name="date" content="2020-01-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dplyr.html"/>
<link rel="next" href="forcats.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-is-r-what-is-rstudio"><i class="fa fa-check"></i><b>1.1</b> What is R? What is RStudio?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-learn-r"><i class="fa fa-check"></i><b>1.2</b> Why learn R?</a><ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#r-does-not-involve-lots-of-pointing-and-clicking-and-thats-a-good-thing"><i class="fa fa-check"></i><b>1.2.1</b> R does not involve lots of pointing and clicking, and that’s a good thing</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#r-code-is-great-for-reproducibility"><i class="fa fa-check"></i><b>1.2.2</b> R code is great for reproducibility</a></li>
<li class="chapter" data-level="1.2.3" data-path="intro.html"><a href="intro.html#r-is-interdisciplinary-and-extensible"><i class="fa fa-check"></i><b>1.2.3</b> R is interdisciplinary and extensible</a></li>
<li class="chapter" data-level="1.2.4" data-path="intro.html"><a href="intro.html#r-works-on-data-of-all-shapes-and-sizes"><i class="fa fa-check"></i><b>1.2.4</b> R works on data of all shapes and sizes</a></li>
<li class="chapter" data-level="1.2.5" data-path="intro.html"><a href="intro.html#r-produces-high-quality-graphics"><i class="fa fa-check"></i><b>1.2.5</b> R produces high-quality graphics</a></li>
<li class="chapter" data-level="1.2.6" data-path="intro.html"><a href="intro.html#r-has-a-large-and-welcoming-community"><i class="fa fa-check"></i><b>1.2.6</b> R has a large and welcoming community</a></li>
<li class="chapter" data-level="1.2.7" data-path="intro.html"><a href="intro.html#not-only-is-r-free-but-it-is-also-open-source-and-cross-platform"><i class="fa fa-check"></i><b>1.2.7</b> Not only is R free, but it is also open-source and cross-platform</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#knowing-your-way-around-rstudio"><i class="fa fa-check"></i><b>1.3</b> Knowing your way around RStudio</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#getting-set-up"><i class="fa fa-check"></i><b>1.4</b> Getting set up</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#create-a-new-project"><i class="fa fa-check"></i><b>1.4.1</b> Create a new project</a></li>
<li class="chapter" data-level="1.4.2" data-path="intro.html"><a href="intro.html#the-rstudio-interface"><i class="fa fa-check"></i><b>1.4.2</b> The RStudio Interface</a></li>
<li class="chapter" data-level="1.4.3" data-path="intro.html"><a href="intro.html#organizing-your-working-directory"><i class="fa fa-check"></i><b>1.4.3</b> Organizing your working directory</a></li>
<li class="chapter" data-level="1.4.4" data-path="intro.html"><a href="intro.html#the-working-directory"><i class="fa fa-check"></i><b>1.4.4</b> The working directory</a></li>
<li class="chapter" data-level="1.4.5" data-path="intro.html"><a href="intro.html#downloading-the-data-and-getting-set-up"><i class="fa fa-check"></i><b>1.4.5</b> Downloading the data and getting set up</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#interacting-with-r"><i class="fa fa-check"></i><b>1.5</b> Interacting with R</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#installing-additional-packages-using-the-packages-tab"><i class="fa fa-check"></i><b>1.6</b> Installing additional packages using the packages tab</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#installing-additional-packages-using-r-code"><i class="fa fa-check"></i><b>1.7</b> Installing additional packages using R code</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="projectmanagement.html"><a href="projectmanagement.html"><i class="fa fa-check"></i><b>2</b> Project Management With RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="projectmanagement.html"><a href="projectmanagement.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="projectmanagement.html"><a href="projectmanagement.html#a-possible-solution"><i class="fa fa-check"></i><b>2.2</b> A possible solution</a></li>
<li class="chapter" data-level="2.3" data-path="projectmanagement.html"><a href="projectmanagement.html#best-practices-for-project-organization"><i class="fa fa-check"></i><b>2.3</b> Best practices for project organization</a><ul>
<li class="chapter" data-level="2.3.1" data-path="projectmanagement.html"><a href="projectmanagement.html#treat-data-as-read-only"><i class="fa fa-check"></i><b>2.3.1</b> Treat data as read only</a></li>
<li class="chapter" data-level="2.3.2" data-path="projectmanagement.html"><a href="projectmanagement.html#data-cleaning"><i class="fa fa-check"></i><b>2.3.2</b> Data Cleaning</a></li>
<li class="chapter" data-level="2.3.3" data-path="projectmanagement.html"><a href="projectmanagement.html#treat-generated-output-as-disposable"><i class="fa fa-check"></i><b>2.3.3</b> Treat generated output as disposable</a></li>
<li class="chapter" data-level="2.3.4" data-path="projectmanagement.html"><a href="projectmanagement.html#separate-function-definition-and-application"><i class="fa fa-check"></i><b>2.3.4</b> Separate function definition and application</a></li>
<li class="chapter" data-level="2.3.5" data-path="projectmanagement.html"><a href="projectmanagement.html#save-the-data-in-the-data-directory"><i class="fa fa-check"></i><b>2.3.5</b> Save the data in the data directory</a></li>
<li class="chapter" data-level="2.3.6" data-path="projectmanagement.html"><a href="projectmanagement.html#version-control"><i class="fa fa-check"></i><b>2.3.6</b> Version Control</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basicR.html"><a href="basicR.html"><i class="fa fa-check"></i><b>3</b> Introduction to R</a><ul>
<li class="chapter" data-level="3.1" data-path="basicR.html"><a href="basicR.html#creating-objects-in-r"><i class="fa fa-check"></i><b>3.1</b> Creating objects in R</a></li>
<li class="chapter" data-level="3.2" data-path="basicR.html"><a href="basicR.html#comments"><i class="fa fa-check"></i><b>3.2</b> Comments</a><ul>
<li class="chapter" data-level="3.2.1" data-path="basicR.html"><a href="basicR.html#functions-and-their-arguments"><i class="fa fa-check"></i><b>3.2.1</b> Functions and their arguments</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="basicR.html"><a href="basicR.html#vectors-and-data-types"><i class="fa fa-check"></i><b>3.3</b> Vectors and data types</a></li>
<li class="chapter" data-level="3.4" data-path="basicR.html"><a href="basicR.html#subsetting-vectors"><i class="fa fa-check"></i><b>3.4</b> Subsetting vectors</a><ul>
<li class="chapter" data-level="3.4.1" data-path="basicR.html"><a href="basicR.html#conditional-subsetting"><i class="fa fa-check"></i><b>3.4.1</b> Conditional subsetting</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="basicR.html"><a href="basicR.html#missing-data"><i class="fa fa-check"></i><b>3.5</b> Missing data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="help.html"><a href="help.html"><i class="fa fa-check"></i><b>4</b> Seeking Help</a><ul>
<li class="chapter" data-level="4.1" data-path="help.html"><a href="help.html#reading-help-files"><i class="fa fa-check"></i><b>4.1</b> Reading Help files</a></li>
<li class="chapter" data-level="4.2" data-path="help.html"><a href="help.html#special-operators"><i class="fa fa-check"></i><b>4.2</b> Special Operators</a></li>
<li class="chapter" data-level="4.3" data-path="help.html"><a href="help.html#getting-help-on-packages"><i class="fa fa-check"></i><b>4.3</b> Getting help on packages</a></li>
<li class="chapter" data-level="4.4" data-path="help.html"><a href="help.html#when-you-kind-of-remember-the-function"><i class="fa fa-check"></i><b>4.4</b> When you kind of remember the function</a></li>
<li class="chapter" data-level="4.5" data-path="help.html"><a href="help.html#when-you-have-no-idea-where-to-begin"><i class="fa fa-check"></i><b>4.5</b> When you have no idea where to begin</a></li>
<li class="chapter" data-level="4.6" data-path="help.html"><a href="help.html#when-your-code-doesnt-work-seeking-help-from-your-peers"><i class="fa fa-check"></i><b>4.6</b> When your code doesn’t work: seeking help from your peers</a></li>
<li class="chapter" data-level="4.7" data-path="help.html"><a href="help.html#other-ports-of-call"><i class="fa fa-check"></i><b>4.7</b> Other ports of call</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataframes.html"><a href="dataframes.html"><i class="fa fa-check"></i><b>5</b> Starting with Data</a><ul>
<li class="chapter" data-level="5.1" data-path="dataframes.html"><a href="dataframes.html#presentation-of-the-safi-data"><i class="fa fa-check"></i><b>5.1</b> Presentation of the SAFI Data</a></li>
<li class="chapter" data-level="5.2" data-path="dataframes.html"><a href="dataframes.html#what-are-data-frames-and-tibbles"><i class="fa fa-check"></i><b>5.2</b> What are data frames and tibbles?</a></li>
<li class="chapter" data-level="5.3" data-path="dataframes.html"><a href="dataframes.html#inspecting-data-frames"><i class="fa fa-check"></i><b>5.3</b> Inspecting data frames</a></li>
<li class="chapter" data-level="5.4" data-path="dataframes.html"><a href="dataframes.html#indexing-and-subsetting-data-frames"><i class="fa fa-check"></i><b>5.4</b> Indexing and subsetting data frames</a></li>
<li class="chapter" data-level="5.5" data-path="dataframes.html"><a href="dataframes.html#factors"><i class="fa fa-check"></i><b>5.5</b> Factors</a><ul>
<li class="chapter" data-level="5.5.1" data-path="dataframes.html"><a href="dataframes.html#converting-factors"><i class="fa fa-check"></i><b>5.5.1</b> Converting factors</a></li>
<li class="chapter" data-level="5.5.2" data-path="dataframes.html"><a href="dataframes.html#renaming-factors"><i class="fa fa-check"></i><b>5.5.2</b> Renaming factors</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="dataframes.html"><a href="dataframes.html#formatting-dates"><i class="fa fa-check"></i><b>5.6</b> Formatting Dates</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>6</b> Data Wrangling with <code>dplyr</code></a><ul>
<li class="chapter" data-level="6.1" data-path="dplyr.html"><a href="dplyr.html#data-manipulation-using-dplyr-and-tidyr"><i class="fa fa-check"></i><b>6.1</b> Data Manipulation using <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong></a></li>
<li class="chapter" data-level="6.2" data-path="dplyr.html"><a href="dplyr.html#what-is-an-r-package"><i class="fa fa-check"></i><b>6.2</b> What is an R package?</a></li>
<li class="chapter" data-level="6.3" data-path="dplyr.html"><a href="dplyr.html#learning-dplyr-and-tidyr"><i class="fa fa-check"></i><b>6.3</b> Learning <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong></a></li>
<li class="chapter" data-level="6.4" data-path="dplyr.html"><a href="dplyr.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>6.4</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="6.5" data-path="dplyr.html"><a href="dplyr.html#pipes"><i class="fa fa-check"></i><b>6.5</b> Pipes</a><ul>
<li class="chapter" data-level="6.5.1" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>6.5.1</b> Mutate</a></li>
<li class="chapter" data-level="6.5.2" data-path="dplyr.html"><a href="dplyr.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>6.5.2</b> Split-apply-combine data analysis and the summarize() function</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dplyr.html"><a href="dplyr.html#reshaping-with-gather-and-spread"><i class="fa fa-check"></i><b>6.6</b> Reshaping with gather and spread</a></li>
<li class="chapter" data-level="6.7" data-path="dplyr.html"><a href="dplyr.html#gathering"><i class="fa fa-check"></i><b>6.7</b> Gathering</a></li>
<li class="chapter" data-level="6.8" data-path="dplyr.html"><a href="dplyr.html#applying-spread-to-clean-our-data"><i class="fa fa-check"></i><b>6.8</b> Applying <code>spread()</code> to clean our data</a></li>
<li class="chapter" data-level="6.9" data-path="dplyr.html"><a href="dplyr.html#exporting-data"><i class="fa fa-check"></i><b>6.9</b> Exporting data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>7</b> Data Visualization with <code>ggplot2</code></a><ul>
<li class="chapter" data-level="7.1" data-path="ggplot.html"><a href="ggplot.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>7.1</b> Plotting with <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="7.2" data-path="ggplot.html"><a href="ggplot.html#building-your-plots-iteratively"><i class="fa fa-check"></i><b>7.2</b> Building your plots iteratively</a></li>
<li class="chapter" data-level="7.3" data-path="ggplot.html"><a href="ggplot.html#boxplot"><i class="fa fa-check"></i><b>7.3</b> Boxplot</a></li>
<li class="chapter" data-level="7.4" data-path="ggplot.html"><a href="ggplot.html#barplots"><i class="fa fa-check"></i><b>7.4</b> Barplots</a></li>
<li class="chapter" data-level="7.5" data-path="ggplot.html"><a href="ggplot.html#adding-labels-and-titles"><i class="fa fa-check"></i><b>7.5</b> Adding Labels and Titles</a></li>
<li class="chapter" data-level="7.6" data-path="ggplot.html"><a href="ggplot.html#faceting"><i class="fa fa-check"></i><b>7.6</b> Faceting</a></li>
<li class="chapter" data-level="7.7" data-path="ggplot.html"><a href="ggplot.html#ggplot2-themes"><i class="fa fa-check"></i><b>7.7</b> <strong><code>ggplot2</code></strong> themes</a></li>
<li class="chapter" data-level="7.8" data-path="ggplot.html"><a href="ggplot.html#customization"><i class="fa fa-check"></i><b>7.8</b> Customization</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="forcats.html"><a href="forcats.html"><i class="fa fa-check"></i><b>8</b> Advanced variable creation with <code>forcats</code></a><ul>
<li class="chapter" data-level="8.1" data-path="forcats.html"><a href="forcats.html#forcats"><i class="fa fa-check"></i><b>8.1</b> ForCats</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="knitr.html"><a href="knitr.html"><i class="fa fa-check"></i><b>9</b> Producing Reports With <code>knitr</code></a><ul>
<li class="chapter" data-level="9.1" data-path="knitr.html"><a href="knitr.html#data-analysis-reports"><i class="fa fa-check"></i><b>9.1</b> Data analysis reports</a></li>
<li class="chapter" data-level="9.2" data-path="knitr.html"><a href="knitr.html#literate-programming"><i class="fa fa-check"></i><b>9.2</b> Literate programming</a></li>
<li class="chapter" data-level="9.3" data-path="knitr.html"><a href="knitr.html#creating-an-r-markdown-file"><i class="fa fa-check"></i><b>9.3</b> Creating an R Markdown file</a></li>
<li class="chapter" data-level="9.4" data-path="knitr.html"><a href="knitr.html#basic-components-of-r-markdown"><i class="fa fa-check"></i><b>9.4</b> Basic components of R Markdown</a></li>
<li class="chapter" data-level="9.5" data-path="knitr.html"><a href="knitr.html#markdown"><i class="fa fa-check"></i><b>9.5</b> Markdown</a></li>
<li class="chapter" data-level="9.6" data-path="knitr.html"><a href="knitr.html#a-bit-more-markdown"><i class="fa fa-check"></i><b>9.6</b> A bit more Markdown</a></li>
<li class="chapter" data-level="9.7" data-path="knitr.html"><a href="knitr.html#r-code-chunks"><i class="fa fa-check"></i><b>9.7</b> R code chunks</a></li>
<li class="chapter" data-level="9.8" data-path="knitr.html"><a href="knitr.html#how-things-get-compiled"><i class="fa fa-check"></i><b>9.8</b> How things get compiled</a></li>
<li class="chapter" data-level="9.9" data-path="knitr.html"><a href="knitr.html#chunk-options"><i class="fa fa-check"></i><b>9.9</b> Chunk options</a></li>
<li class="chapter" data-level="9.10" data-path="knitr.html"><a href="knitr.html#inline-r-code"><i class="fa fa-check"></i><b>9.10</b> Inline R code</a></li>
<li class="chapter" data-level="9.11" data-path="knitr.html"><a href="knitr.html#other-output-options"><i class="fa fa-check"></i><b>9.11</b> Other output options</a></li>
<li class="chapter" data-level="9.12" data-path="knitr.html"><a href="knitr.html#resources"><i class="fa fa-check"></i><b>9.12</b> Resources</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">2020-01-15-brynmawr</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ggplot" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Data Visualization with <code>ggplot2</code></h1>
<p>teaching: 80<br />
exercises: 35<br />
adapted from: <a href="https://datacarpentry.org/r-socialsci/04-ggplot2/index.html" class="uri">https://datacarpentry.org/r-socialsci/04-ggplot2/index.html</a></p>
<p>questions:</p>
<ul>
<li>What are the components of a ggplot?<br />
</li>
<li>How do I create scatterplots, boxplots, and barplots?<br />
</li>
<li>How can I change the aesthetics (ex. colour, transparency) of my plot?<br />
</li>
<li>How can I create multiple plots at once?</li>
</ul>
<p>objectives:</p>
<ul>
<li>Produce scatter plots, boxplots, and time series plots using ggplot.<br />
</li>
<li>Set universal plot settings.<br />
</li>
<li>Describe what faceting is and apply faceting in ggplot.<br />
</li>
<li>Modify the aesthetics of an existing ggplot plot (including axis labels and color).<br />
</li>
<li>Build complex and customized plots from data in a data frame.</li>
</ul>
<p>keypoints:</p>
<ul>
<li><code>ggplot2</code> is a flexible and useful tool for creating plots in R.<br />
</li>
<li>The data set and coordinate system can be defined using the <code>ggplot</code> function.<br />
</li>
<li>Additional layers, including geoms, are added using the <code>+</code> operator.<br />
</li>
<li>Boxplots are useful for visualizing the distribution of a continuous variable.<br />
</li>
<li>Barplot are useful for visualizing categorical data.<br />
</li>
<li>Faceting allows you to generate multiple plots based on a categorical variable.</li>
</ul>
<p>We start by loading the required package. <strong><code>ggplot2</code></strong> is also included in the <strong><code>tidyverse</code></strong> package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<p>If not still in the workspace, load the data we saved in the previous lesson.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">interviews_plotting &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data_output/interviews_plotting.csv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   .default = col_logical(),
##   key_ID = col_double(),
##   village = col_character(),
##   interview_date = col_datetime(format = &quot;&quot;),
##   no_membrs = col_double(),
##   years_liv = col_double(),
##   respondent_wall_type = col_character(),
##   rooms = col_double(),
##   memb_assoc = col_character(),
##   affect_conflicts = col_character(),
##   liv_count = col_double(),
##   no_meals = col_double(),
##   instanceID = col_character(),
##   number_months_lack_food = col_double(),
##   number_items = col_double()
## )</code></pre>
<pre><code>## See spec(...) for full column specifications.</code></pre>
<div id="plotting-with-ggplot2" class="section level2">
<h2><span class="header-section-number">7.1</span> Plotting with <strong><code>ggplot2</code></strong></h2>
<p><strong><code>ggplot2</code></strong> is a plotting package that makes it simple to create complex plots from data stored in a data frame. It provides a programmatic interface for specifying what variables to plot, how they are displayed, and general visual properties. Therefore, we only need minimal changes if the underlying data change or if we decide to change from a bar plot to a scatterplot. This helps in creating publication quality plots with minimal amounts of adjustments and tweaking.</p>
<p><strong><code>ggplot2</code></strong> functions like data in the ‘long’ format, i.e., a column for every dimension, and a row for every observation. Well-structured data will save you lots of time when making figures with <strong><code>ggplot2</code></strong></p>
<p>ggplot graphics are built step by step by adding new elements. Adding layers in this fashion allows for extensive flexibility and customization of plots.</p>
<p>To build a ggplot, we will use the following basic template that can be used for different types of plots:</p>
<pre><code>ggplot(data = &lt;DATA&gt;, mapping = aes(&lt;MAPPINGS&gt;)) +  &lt;GEOM_FUNCTION&gt;()</code></pre>
<ul>
<li>use the <code>ggplot()</code> function and bind the plot to a specific data frame using the <code>data</code> argument</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting)</code></pre></div>
<ul>
<li>define a mapping (using the aesthetic (<code>aes</code>) function), by selecting the variables to be plotted and specifying how to present them in the graph, e.g. as x/y positions or characteristics such as size, shape, color, etc.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items))</code></pre></div>
<ul>
<li><p>add ‘geoms’ – graphical representations of the data in the plot (points, lines, bars). <strong><code>ggplot2</code></strong> offers many different geoms; we will use some common ones today, including:</p></li>
<li><code>geom_point()</code> for scatter plots, dot plots, etc.</li>
<li><code>geom_boxplot()</code> for, well, boxplots!</li>
<li><p><code>geom_line()</code> for trend lines, time series, etc.</p></li>
</ul>
<p>To add a geom to the plot use the <code>+</code> operator. Because we have two continuous variables, let’s use <code>geom_point()</code> first:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/first-ggplot-1.png" width="672" /></p>
<p>The <code>+</code> in the <strong><code>ggplot2</code></strong> package is particularly useful because it allows you to modify existing <code>ggplot</code> objects. This means you can easily set up plot templates and conveniently explore different types of plots, so the above plot can also be generated with code like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assign plot to a variable</span>
interviews_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items))

<span class="co"># Draw the plot</span>
interviews_plot <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre></div>
<blockquote>
<h2 id="notes"><span class="header-section-number">7.1</span> Notes</h2>
<ul>
<li>Anything you put in the <code>ggplot()</code> function can be seen by any geom layers that you add (i.e., these are universal plot settings). This includes the x- and y-axis mapping you set up in <code>aes()</code>.</li>
<li>You can also specify mappings for a given geom independently of the mapping defined globally in the <code>ggplot()</code> function.</li>
<li>The <code>+</code> sign used to add new layers must be placed at the end of the line containing the <em>previous</em> layer. If, instead, the <code>+</code> sign is added at the beginning of the line containing the new layer, <strong><code>ggplot2</code></strong> will not add the new layer and will return an error message. {: .callout}</li>
</ul>
</blockquote>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## This is the correct syntax for adding layers
interviews_plot <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()

## This will not add the new layer and will return an error message
interviews_plot
<span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
</div>
<div id="building-your-plots-iteratively" class="section level2">
<h2><span class="header-section-number">7.2</span> Building your plots iteratively</h2>
<p>Building plots with <strong><code>ggplot2</code></strong> is typically an iterative process. We start by defining the dataset we’ll use, lay out the axes, and choose a geom:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/create-ggplot-object-1.png" width="672" /></p>
<p>Then, we start modifying this plot to extract more information from it. For instance, we can add transparency (<code>alpha</code>) to avoid overplotting:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/adding-transparency-1.png" width="672" /></p>
<p>That only helped a little bit with the overplotting problem. We can also introduce a little bit of randomness into the position of our points using the <code>geom_jitter()</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/adding-jitter-1.png" width="672" /></p>
<p>We can also add colors for all the points:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/adding-colors-1.png" width="672" /></p>
<p>Or to color each species in the plot differently, you could use a vector as an input to the argument <strong><code>color</code></strong>. Because we are now mapping features of the data to a color, instead of setting one color for all points, the color now needs to be set inside a call to the <strong><code>aes</code></strong> function. <strong><code>ggplot2</code></strong> will provide a different color corresponding to different values in the vector. We set the value of <strong><code>alpha</code></strong> outside of the <strong><code>aes</code></strong> function call because we are using the same value for all points. Here is an example where we color by <strong><code>village</code></strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> no_membrs, <span class="dt">y =</span> number_items)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> village), <span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/color-by-species-1.png" width="672" /></p>
<p>There appears to be a positive trend between number of household members and number of items owned (from the list provided). This trend does not appear to be different by village.</p>
<blockquote>
<h2 id="exercise-12"><span class="header-section-number">7.2</span> Exercise</h2>
<p>Use what you just learned to create a scatter plot of <code>rooms</code> by <code>village</code> with the <code>respondent_wall_type</code> showing in different colors. Is this a good way to show this type of data?</p>
<blockquote>
<h2 id="solution-16"><span class="header-section-number">7.2</span> Solution</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> rooms)) <span class="op">+</span>
<span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">color =</span> respondent_wall_type))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/scatter-challenge-1.png" width="672" /> This is not a good way to show this type of data because it is difficult to distinguish between villages. {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</div>
<div id="boxplot" class="section level2">
<h2><span class="header-section-number">7.3</span> Boxplot</h2>
<p>We can use boxplots to visualize the distribution of rooms for each wall type:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> rooms)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/boxplot-1.png" width="672" /></p>
<p>By adding points to a boxplot, we can have a better idea of the number of measurements and of their distribution:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> rooms)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/boxplot-with-points-1.png" width="672" /></p>
<p>We can see that muddaub houses and sunbrick houses tend to be smaller than burntbrick houses.</p>
<p>Notice how the boxplot layer is behind the jitter layer? What do you need to change in the code to put the boxplot in front of the points such that it’s not hidden?</p>
<blockquote>
<h2 id="exercise-13"><span class="header-section-number">7.3</span> Exercise</h2>
<p>Boxplots are useful summaries, but hide the <em>shape</em> of the distribution. For example, if the distribution is bimodal, we would not see it in a boxplot. An alternative to the boxplot is the violin plot, where the shape (of the density of points) is drawn.</p>
<ul>
<li>Replace the box plot with a violin plot; see <code>geom_violin()</code>.</li>
</ul>
<blockquote>
<h2 id="solution-17"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> rooms)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;tomato&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/violin-plot-1.png" width="672" /> {: .solution}</p>
</blockquote>
<p>So far, we’ve looked at the distribution of room number within wall type. Try making a new plot to explore the distribution of another variable within wall type.</p>
<ul>
<li>Create a boxplot for <code>liv_count</code> for each wall type. Overlay the boxplot layer on a jitter layer to show actual measurements.</li>
</ul>
<blockquote>
<h2 id="solution-18"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> liv_count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/boxplot-exercise-1.png" width="672" /> {: .solution}</p>
</blockquote>
<ul>
<li>Add color to the data points on your boxplot according to whether the respondent is a member of an irrigation association (<code>memb_assoc</code>).</li>
</ul>
<blockquote>
<h2 id="solution-19"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> liv_count)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="dv">0</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="kw">aes</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> memb_assoc))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/boxplot-exercise-factor-1.png" width="672" /> {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</div>
<div id="barplots" class="section level2">
<h2><span class="header-section-number">7.4</span> Barplots</h2>
<p>Barplots are also useful for visualizing categorical data. By default, <code>geom_bar</code> accepts a variable for x, and plots the number of instances each value of x (in this case, wall type) appears in the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-1-1.png" width="672" /></p>
<p>We can use the <code>fill</code> aesthetic for the <code>geom_bar()</code> geom to color bars by the portion of each count that is from each village.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> village))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-stack-1.png" width="672" /></p>
<p>This creates a stacked bar chart. These are generally more difficult to read than side-by-side bars. We can separate the portions of the stacked bar that correspond to each village and put them side-by-side by using the <code>position</code> argument for <code>geom_bar()</code> and setting it to “dodge”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> interviews_plotting, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> village), <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-dodge-1.png" width="672" /></p>
<p>This is a nicer graphic, but we’re more likely to be interested in the proportion of each housing type in each village than in the actual count of number of houses of each type (because we might have sampled different numbers of households in each village). To compare proportions, we will first create a new data frame (<code>percent_wall_type</code>) with a new column named “percent” representing the percent of each house type in each village. We will remove houses with cement walls, as there was only one in the dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">percent_wall_type &lt;-<span class="st"> </span>interviews_plotting <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(respondent_wall_type <span class="op">!=</span><span class="st"> &quot;cement&quot;</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">count</span>(village, respondent_wall_type) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(village) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">percent =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ungroup</span>()</code></pre></div>
<p>Now we can use this new data frame to create our plot showing the percentage of each house type in each village.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"> <span class="kw">ggplot</span>(percent_wall_type, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent, <span class="dt">fill =</span> respondent_wall_type)) <span class="op">+</span>
<span class="st">     </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-wall-type-1.png" width="672" /></p>
<blockquote>
<h2 id="exercise-14"><span class="header-section-number">7.4</span> Exercise</h2>
<p>Create a bar plot showing the proportion of respondents in each village who are or are not part of an irrigation association (<code>memb_assoc</code>). Include only respondents who answered that question in the calculations and plot. Which village had the lowest proportion of respondents in an irrigation association?</p>
<blockquote>
<h2 id="solution-20"><span class="header-section-number">7.4</span> Solution</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">percent_memb_assoc &lt;-<span class="st"> </span>interviews_plotting <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(memb_assoc)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(village, memb_assoc) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(village) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">percent =</span> n <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ungroup</span>()

<span class="kw">ggplot</span>(percent_memb_assoc, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent, <span class="dt">fill =</span> memb_assoc)) <span class="op">+</span>
<span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-memb-assoc-1.png" width="672" /></p>
<p>Ruaca had the lowest proportion of members in an irrigation association. {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</div>
<div id="adding-labels-and-titles" class="section level2">
<h2><span class="header-section-number">7.5</span> Adding Labels and Titles</h2>
<p>By default, the axes labels on a plot are determined by the name of the variable being plotted. However, <strong><code>ggplot2</code></strong> offers lots of customization options, like specifying the axes labels, and adding a title to the plot with relatively few lines of code. We will add more informative x and y axis labels to our plot of proportion of house type by village and also add a title.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_wall_type, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent, <span class="dt">fill =</span> respondent_wall_type)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Proportion of wall type by village&quot;</span>,
         <span class="dt">x=</span><span class="st">&quot;Wall Type&quot;</span>,
         <span class="dt">y=</span><span class="st">&quot;Percent&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-wall-types-labeled-1.png" width="672" /></p>
</div>
<div id="faceting" class="section level2">
<h2><span class="header-section-number">7.6</span> Faceting</h2>
<p>Rather than creating a single plot with side-by-side bars for each village, we may want to create multiple plot, where each plot shows the data for a single village. This would be especially useful if we had a large number of villages that we had sampled, as a large number of side-by-side bars will become more difficult to read.</p>
<p><strong><code>ggplot2</code></strong> has a special technique called <em>faceting</em> that allows the user to split one plot into multiple plots based on a factor included in the dataset. We will use it to split our barplot of housing type proportion by village so that each village has it’s own panel in a multi-panel plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_wall_type, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Proportion of wall type by village&quot;</span>,
         <span class="dt">x=</span><span class="st">&quot;Wall Type&quot;</span>,
         <span class="dt">y=</span><span class="st">&quot;Percent&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>village)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-faceting-1.png" width="672" /></p>
<p>Click the “Zoom” button in your RStudio plots pane to view a larger version of this plot.</p>
<p>Usually plots with white background look more readable when printed. We can set the background to white using the function <code>theme_bw()</code>. Additionally, you can remove the grid:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_wall_type, <span class="kw">aes</span>(<span class="dt">x =</span> respondent_wall_type, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Proportion of wall type by village&quot;</span>,
         <span class="dt">x=</span><span class="st">&quot;Wall Type&quot;</span>,
         <span class="dt">y=</span><span class="st">&quot;Percent&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>village) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/barplot-theme-bw-1.png" width="672" /></p>
<p>What if we wanted to see the proportion of respondents in each village who owned a particular item? We can calculate the percent of people in each village who own each item and then create a faceted series of bar plots where each plot is a particular item. First we need to calculate the percentage of people in each village who own each item:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">percent_items &lt;-<span class="st"> </span>interviews_plotting <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">gather</span>(items, items_owned_logical, bicycle<span class="op">:</span>no_listed_items) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(items_owned_logical) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">count</span>(items, village) <span class="op">%&gt;%</span>
<span class="st">    </span>## add a column with the number of people in each village
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">people_in_village =</span> <span class="kw">case_when</span>(village <span class="op">==</span><span class="st"> &quot;Chirodzo&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">39</span>,
                                         village <span class="op">==</span><span class="st"> &quot;God&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">43</span>,
                                         village <span class="op">==</span><span class="st"> &quot;Ruaca&quot;</span> <span class="op">~</span><span class="st"> </span><span class="dv">49</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">percent =</span> n <span class="op">/</span><span class="st"> </span>people_in_village)</code></pre></div>
<p>To calculate this percentage data frame, we needed to use the <code>case_when()</code> parameter within <code>mutate()</code>. In our earlier examples, we knew that each house was one and only one of the types specified. However, people can (and do) own more than one item, so we can’t use the sum of the count column to give us the denominator in our percentage calculation. Instead, we need to specify the number of respondents in each village. Using this data frame, we can now create a multi-paneled bar plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid =</span> <span class="kw">element_blank</span>())</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/percent-items-barplot-1.png" width="672" /></p>
</div>
<div id="ggplot2-themes" class="section level2">
<h2><span class="header-section-number">7.7</span> <strong><code>ggplot2</code></strong> themes</h2>
<p>In addition to <code>theme_bw()</code>, which changes the plot background to white, <strong><code>ggplot2</code></strong> comes with several other themes which can be useful to quickly change the look of your visualization. The complete list of themes is available at <a href="http://docs.ggplot2.org/current/ggtheme.html" class="uri">http://docs.ggplot2.org/current/ggtheme.html</a>. <code>theme_minimal()</code> and <code>theme_light()</code> are popular, and <code>theme_void()</code> can be useful as a starting point to create a new hand-crafted theme.</p>
<p>The <a href="https://jrnold.github.io/ggthemes/reference/index.html">ggthemes</a> package provides a wide variety of options (including an Excel 2003 theme). The <a href="https://www.ggplot2-exts.org"><strong><code>ggplot2</code></strong> extensions website</a> provides a list of packages that extend the capabilities of <strong><code>ggplot2</code></strong>, including additional themes.</p>
<blockquote>
<h2 id="exercise-15"><span class="header-section-number">7.7</span> Exercise</h2>
<p>Experiment with at least two different themes. Build the previous plot using each of those themes. Which do you like best? {: .challenge}</p>
</blockquote>
</div>
<div id="customization" class="section level2">
<h2><span class="header-section-number">7.8</span> Customization</h2>
<p>Take a look at the <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf"><strong><code>ggplot2</code></strong> cheat sheet</a>, and think of ways you could improve the plot.</p>
<p>Now, let’s change names of axes to something more informative than ‘village’ and ‘percent’ and add a title to the figure:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of respondents in each village who owned each item&quot;</span>,
         <span class="dt">x =</span> <span class="st">&quot;Village&quot;</span>,
         <span class="dt">y =</span> <span class="st">&quot;Percent of Respondents&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggplot-customization-1.png" width="672" /></p>
<p>The axes have more informative names, but their readability can be improved by increasing the font size:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of respondents in each village who owned each item&quot;</span>,
         <span class="dt">x =</span> <span class="st">&quot;Village&quot;</span>,
         <span class="dt">y =</span> <span class="st">&quot;Percent of Respondents&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text=</span><span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggplot-customization-font-size-1.png" width="672" /></p>
<p>Note that it is also possible to change the fonts of your plots. If you are on Windows, you may have to install the <a href="https://github.com/wch/extrafont"><strong><code>extrafont</code></strong> package</a>, and follow the instructions included in the README for this package.</p>
<p>After our manipulations, you may notice that the values on the x-axis are still not properly readable. Let’s change the orientation of the labels and adjust them vertically and horizontally so they don’t overlap. You can use a 90-degree angle, or experiment to find the appropriate angle for diagonally oriented labels. With a larger font, the title also runs off. We can <code>\n</code> in the string for the title to insert a new line:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of respondents in each village </span><span class="ch">\n</span><span class="st"> who owned each item&quot;</span>,
         <span class="dt">x =</span> <span class="st">&quot;Village&quot;</span>,
         <span class="dt">y =</span> <span class="st">&quot;Percent of Respondents&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>),
          <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>))</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggplot-customization-label-orientation-1.png" width="672" /></p>
<p>If you like the changes you created better than the default theme, you can save them as an object to be able to easily apply them to other plots you may create. We can also add <code>plot.title = element_text(hjust = 0.5)</code> to center the title:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grey_theme &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),
                    <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>),
                    <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
                    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))


<span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of respondents in each village </span><span class="ch">\n</span><span class="st"> who owned each item&quot;</span>,
         <span class="dt">x =</span> <span class="st">&quot;Village&quot;</span>,
         <span class="dt">y =</span> <span class="st">&quot;Percent of Respondents&quot;</span>) <span class="op">+</span>
<span class="st">    </span>grey_theme</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/ggplot-custom-themes-1.png" width="672" /></p>
<blockquote>
<h2 id="exercise-16"><span class="header-section-number">7.8</span> Exercise</h2>
<p>With all of this information in hand, please take another five minutes to either improve one of the plots generated in this exercise or create a beautiful graph of your own. Use the RStudio <a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf"><strong><code>ggplot2</code></strong> cheat sheet</a> for inspiration. Here are some ideas:</p>
<ul>
<li>See if you can make the bars white with black outline.</li>
<li>Try using a different color palette (see <a href="http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/" class="uri">http://www.cookbook-r.com/Graphs/Colors_(ggplot2)/</a>). {: .challenge}</li>
</ul>
</blockquote>
<p>After creating your plot, you can save it to a file in your favorite format. The Export tab in the <strong>Plot</strong> pane in RStudio will save your plots at low resolution, which will not be accepted by many journals and will not scale well for posters.</p>
<p>Instead, use the <code>ggsave()</code> function, which allows you easily change the dimension and resolution of your plot by adjusting the appropriate arguments (<code>width</code>, <code>height</code> and <code>dpi</code>).</p>
<p>Make sure you have the <code>fig_output/</code> folder in your working directory.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(percent_items, <span class="kw">aes</span>(<span class="dt">x =</span> village, <span class="dt">y =</span> percent)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>items) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of respondents in each village </span><span class="ch">\n</span><span class="st"> who owned each item&quot;</span>,
         <span class="dt">x =</span> <span class="st">&quot;Village&quot;</span>,
         <span class="dt">y =</span> <span class="st">&quot;Percent of Respondents&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>, <span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="fl">0.5</span>, <span class="dt">vjust =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.text.y =</span> <span class="kw">element_text</span>(<span class="dt">colour =</span> <span class="st">&quot;grey20&quot;</span>, <span class="dt">size =</span> <span class="dv">12</span>),
          <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">16</span>),
          <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>))

<span class="kw">ggsave</span>(<span class="st">&quot;fig_output/name_of_file.png&quot;</span>, my_plot, <span class="dt">width =</span> <span class="dv">15</span>, <span class="dt">height =</span> <span class="dv">10</span>)</code></pre></div>
<p>Note: The parameters <code>width</code> and <code>height</code> also determine the font size in the saved plot.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dplyr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="forcats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-ggplot2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
